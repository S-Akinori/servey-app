import{r as h,j as e,W as E,a as P,d as N}from"./app-f8597ad7.js";import{A as $}from"./AuthenticatedLayout-dd135956.js";import{b as v,R as F,F as f,a as g}from"./Box-65be46cb.js";import{B as x}from"./Button-5c3a20cf.js";import{g as L,s as M,u as O,b as B,_ as w,d as W,e as V,C as X}from"./Container-61250ba4.js";import{F as q,P as G}from"./FormControl-fe288f95.js";import{g as H}from"./TransitionGroupContext-202f118a.js";import{T as I,a as J,b as y,c as i,d as K}from"./TableRow-982c8607.js";/* empty css            */import"./ApplicationLogo-7cdc9c0b.js";import"./ResponsiveNavLink-a50aba77.js";import"./transition-81969ff5.js";import"./NavLink-d477c64f.js";import"./Typography-e6ad6181.js";import"./extendSxProp-7e23cc6a.js";import"./ButtonBase-337318eb.js";import"./createSvgIcon-af4510f6.js";function z(t){return L("MuiTableContainer",t)}H("MuiTableContainer",["root"]);const Q=["className","component"],Y=t=>{const{classes:s}=t;return V({root:["root"]},z,s)},Z=M("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(t,s)=>s.root})({width:"100%",overflowX:"auto"}),D=h.forwardRef(function(s,d){const l=O({props:s,name:"MuiTableContainer"}),{className:c,component:u="div"}=l,p=B(l,Q),a=w({},l,{component:u}),j=Y(a);return e.jsx(Z,w({ref:d,as:u,className:W(j.root,c),ownerState:a},p))}),ee=D,T=(t,s)=>t===0?-1:Math.floor(s*1e3/t)/10;function Ce({auth:t,clientData:s,target:d="all",total:l,answerTotal:c}){const p=new URLSearchParams(window.location.search).get("user_id"),{data:a,setData:j,get:_,post:se}=E({target:d,user_id:p??""}),[C,R]=h.useState([]),[re,S]=h.useState([]);h.useEffect(()=>{const o=s.data.filter(r=>r.responses.length>=2),n=s.data.filter(r=>r.responses.length<2);R(o),S(n)},[]);const k=o=>{o.preventDefault(),console.log(a),_(route("dashboard",{target:a.target,user_id:a.user_id}))},A=()=>{var n;const o=(n=document==null?void 0:document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content");fetch(route("download"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":o||""},body:JSON.stringify(a)}).then(r=>r.blob()).then(r=>{const U=window.URL.createObjectURL(r),m=document.createElement("a");m.href=U,m.download=`${t.user.name}.csv`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}).catch(r=>console.error("Error:",r))},b=o=>{const n={...a,target:o.target.value};j(n)};return e.jsxs($,{user:t.user,header:e.jsx("h2",{className:"font-semibold leading-tight",children:t.user.name}),children:[e.jsx(P,{title:"クライアント管理者ダッシュボード"}),e.jsx(X,{className:"py-12",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"pb-12",children:e.jsx("div",{className:"flex justify-center max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"md:flex items-center px-4 mb-4",children:[e.jsx("div",{className:"md:pr-2 font-bold text-center",children:"回答状況"}),e.jsxs(v,{className:"text-center",children:[T(l,c)!==-1?T(l,c):"-","%"]})]}),e.jsxs("div",{className:"md:flex items-center px-4 mb-4",children:[e.jsx("div",{className:"md:pr-2 font-bold text-center",children:"回答数"}),e.jsxs(v,{className:"text-center",children:[c,"名 / ",l,"名"]})]})]})})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("form",{onSubmit:k,children:e.jsxs(q,{children:[e.jsxs(F,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"female",name:"radio-buttons-group",row:!0,children:[e.jsx(f,{value:"all",control:e.jsx(g,{onChange:b}),checked:a.target==="all",label:"全員"}),e.jsx(f,{value:"no-answer",control:e.jsx(g,{onChange:b}),checked:a.target==="no-answer",label:"未回答"}),e.jsx(f,{value:"answer",control:e.jsx(g,{onChange:b}),checked:a.target==="answer",label:"回答済"})]}),e.jsx("div",{className:"text-center",children:e.jsx(x,{children:"抽出"})})]})})}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{style:{maxWidth:"650px"},className:"mx-auto",children:[e.jsx(ee,{component:G,children:e.jsxs(I,{"aria-label":"simple table",children:[e.jsx(J,{children:e.jsxs(y,{children:[e.jsx(i,{children:"NO."}),e.jsx(i,{children:"従業員ID"}),e.jsx(i,{children:"回答状況"})]})}),e.jsx(K,{children:s&&s.data.map((o,n)=>e.jsxs(y,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(i,{scope:"row",children:s.from+n}),e.jsx(i,{children:o.client_id}),e.jsx(i,{className:C.some(r=>r.id===o.id)?"":"bg-main text-main-cont",children:C.some(r=>r.id===o.id)?"回答済":"未回答"})]},o.id))})]})}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[(s==null?void 0:s.prev_page_url)&&e.jsx(x,{className:"mr-auto",children:e.jsx(N,{href:`/dashboard?target=${d}&page=${s.current_page-1}`,children:"前へ"})}),(s==null?void 0:s.next_page_url)&&e.jsx(x,{className:"ml-auto",children:e.jsx(N,{href:`/dashboard?target=${d}&page=${s.current_page+1}`,children:"次へ"})})]})]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(x,{onClick:A,children:"CSVダウンロード"})})]})})]})}export{Ce as default};
