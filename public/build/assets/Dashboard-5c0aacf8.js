import{r as p,j as e,W as E,a as U,d as N}from"./app-68050979.js";import{A as $}from"./AuthenticatedLayout-92e1e4c9.js";import{b as v,R as F,F as b,a as f}from"./Box-71090b17.js";import{B as h}from"./Button-9e76dcf7.js";import{g as M,s as O,u as P,b as B,_ as w,d as L,e as W,C as V}from"./Container-0e95935a.js";import{F as X,P as q}from"./FormControl-554ab2d5.js";import{g as G}from"./TransitionGroupContext-d19eaafc.js";import{T as H,a as I,b as y,c,d as J}from"./TableRow-3c188db4.js";/* empty css            */import"./ApplicationLogo-8afda6e7.js";import"./ResponsiveNavLink-89c15b17.js";import"./transition-950ae369.js";import"./NavLink-a106a817.js";import"./Typography-2c880b31.js";import"./extendSxProp-e189ea43.js";import"./ButtonBase-d60102d8.js";import"./createSvgIcon-2d4d45c8.js";function K(t){return M("MuiTableContainer",t)}G("MuiTableContainer",["root"]);const z=["className","component"],Q=t=>{const{classes:s}=t;return W({root:["root"]},K,s)},Y=O("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(t,s)=>s.root})({width:"100%",overflowX:"auto"}),Z=p.forwardRef(function(s,d){const l=P({props:s,name:"MuiTableContainer"}),{className:i,component:a="div"}=l,u=B(l,z),x=w({},l,{component:a}),g=Q(x);return e.jsx(Y,w({ref:d,as:a,className:L(g.root,i),ownerState:x},u))}),D=Z,T=(t,s)=>t===0?0:Math.floor(s*100/t);function fe({auth:t,clientData:s,target:d="all",total:l,answerTotal:i}){console.log(s);const{data:a,setData:u,get:x,post:g}=E({target:d}),[C,R]=p.useState([]),[ee,_]=p.useState([]);p.useEffect(()=>{const o=s.data.filter(r=>r.responses.length>=2),n=s.data.filter(r=>r.responses.length<2);R(o),_(n)},[]);const S=o=>{o.preventDefault(),console.log(a),x(route("dashboard",{target:a.target}))},k=()=>{var n;console.log("downloading");const o=(n=document==null?void 0:document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content");console.log(o),fetch(route("download"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":o||""},body:JSON.stringify(a)}).then(r=>r.blob()).then(r=>{const A=window.URL.createObjectURL(r),m=document.createElement("a");m.href=A,m.download=`${t.user.name}.csv`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}).catch(r=>console.error("Error:",r))},j=o=>{const n={target:o.target.value};u(n)};return e.jsxs($,{user:t.user,header:e.jsx("h2",{className:"font-semibold leading-tight",children:t.user.name}),children:[e.jsx(U,{title:"クライアント管理者ダッシュボード"}),e.jsx(V,{className:"py-12",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"pb-12",children:e.jsx("div",{className:"flex justify-center max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"md:flex items-center px-4 mb-4",children:[e.jsx("div",{className:"md:pr-2 font-bold text-center",children:"回答状況"}),e.jsxs(v,{className:"text-center",children:[T(l,i)!==0?T(l,i):"-","%"]})]}),e.jsxs("div",{className:"md:flex items-center px-4 mb-4",children:[e.jsx("div",{className:"md:pr-2 font-bold text-center",children:"回答数"}),e.jsxs(v,{className:"text-center",children:[i,"名 / ",l,"名"]})]})]})})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("form",{onSubmit:S,children:e.jsxs(X,{children:[e.jsxs(F,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"female",name:"radio-buttons-group",row:!0,children:[e.jsx(b,{value:"all",control:e.jsx(f,{onChange:j}),checked:a.target==="all",label:"全員"}),e.jsx(b,{value:"no-answer",control:e.jsx(f,{onChange:j}),checked:a.target==="no-answer",label:"未回答"}),e.jsx(b,{value:"answer",control:e.jsx(f,{onChange:j}),checked:a.target==="answer",label:"回答済"})]}),e.jsx("div",{className:"text-center",children:e.jsx(h,{children:"抽出"})})]})})}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{style:{maxWidth:"650px"},className:"mx-auto",children:[e.jsx(D,{component:q,children:e.jsxs(H,{"aria-label":"simple table",children:[e.jsx(I,{children:e.jsxs(y,{children:[e.jsx(c,{children:"NO."}),e.jsx(c,{children:"従業員ID"}),e.jsx(c,{children:"回答状況"})]})}),e.jsx(J,{children:s&&s.data.map((o,n)=>e.jsxs(y,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(c,{scope:"row",children:s.from+n}),e.jsx(c,{children:o.client_id}),e.jsx(c,{className:C.some(r=>r.id===o.id)?"":"bg-main text-main-cont",children:C.some(r=>r.id===o.id)?"回答済":"未回答"})]},o.id))})]})}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[(s==null?void 0:s.prev_page_url)&&e.jsx(h,{className:"mr-auto",children:e.jsx(N,{href:`/dashboard?target=${d}&page=${s.current_page-1}`,children:"前へ"})}),(s==null?void 0:s.next_page_url)&&e.jsx(h,{className:"ml-auto",children:e.jsx(N,{href:`/dashboard?target=${d}&page=${s.current_page+1}`,children:"次へ"})})]})]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(h,{onClick:k,children:"CSVダウンロード"})})]})})]})}export{fe as default};
