import{r as h,j as e,W as E,a as P,d as N}from"./app-699352bc.js";import{A as $}from"./AuthenticatedLayout-d52a0d26.js";import{b as v,R as F,F as f,a as g}from"./Box-c77ebff8.js";import{B as x}from"./Button-fb4ae37e.js";import{g as L,s as M,u as O,b as B,_ as w,d as W,e as V,C as X}from"./Container-7d9d3412.js";import{F as q,P as G}from"./FormControl-87349e35.js";import{g as H}from"./TransitionGroupContext-ec691407.js";import{T as I,a as J,b as y,c as i,d as K}from"./TableRow-2146d858.js";/* empty css            */import"./ApplicationLogo-129949e6.js";import"./ResponsiveNavLink-af10266e.js";import"./transition-6cd4489d.js";import"./NavLink-228c6d03.js";import"./Typography-009b42f0.js";import"./extendSxProp-bc64032e.js";import"./ButtonBase-6b85ae5a.js";import"./createSvgIcon-81bc5d81.js";function z(o){return L("MuiTableContainer",o)}H("MuiTableContainer",["root"]);const Q=["className","component"],Y=o=>{const{classes:s}=o;return V({root:["root"]},z,s)},Z=M("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(o,s)=>s.root})({width:"100%",overflowX:"auto"}),D=h.forwardRef(function(s,d){const l=O({props:s,name:"MuiTableContainer"}),{className:c,component:u="div"}=l,p=B(l,Q),t=w({},l,{component:u}),j=Y(t);return e.jsx(Z,w({ref:d,as:u,className:W(j.root,c),ownerState:t},p))}),ee=D,T=(o,s)=>o===0?0:Math.floor(s*100/o);function Ce({auth:o,clientData:s,target:d="all",total:l,answerTotal:c}){console.log(s),console.log(c);const p=new URLSearchParams(window.location.search).get("user_id"),{data:t,setData:j,get:_,post:se}=E({target:d,user_id:p??""}),[C,R]=h.useState([]),[re,S]=h.useState([]);console.log(t),h.useEffect(()=>{const a=s.data.filter(r=>r.responses.length>=2),n=s.data.filter(r=>r.responses.length<2);R(a),S(n)},[]);const k=a=>{a.preventDefault(),console.log(t),_(route("dashboard",{target:t.target,user_id:t.user_id}))},A=()=>{var n;const a=(n=document==null?void 0:document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content");fetch(route("download"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":a||""},body:JSON.stringify(t)}).then(r=>r.blob()).then(r=>{const U=window.URL.createObjectURL(r),m=document.createElement("a");m.href=U,m.download=`${o.user.name}.csv`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}).catch(r=>console.error("Error:",r))},b=a=>{const n={...t,target:a.target.value};j(n)};return e.jsxs($,{user:o.user,header:e.jsx("h2",{className:"font-semibold leading-tight",children:o.user.name}),children:[e.jsx(P,{title:"クライアント管理者ダッシュボード"}),e.jsx(X,{className:"py-12",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"pb-12",children:e.jsx("div",{className:"flex justify-center max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"md:flex items-center px-4 mb-4",children:[e.jsx("div",{className:"md:pr-2 font-bold text-center",children:"回答状況"}),e.jsxs(v,{className:"text-center",children:[T(l,c)!==0?T(l,c):"-","%"]})]}),e.jsxs("div",{className:"md:flex items-center px-4 mb-4",children:[e.jsx("div",{className:"md:pr-2 font-bold text-center",children:"回答数"}),e.jsxs(v,{className:"text-center",children:[c,"名 / ",l,"名"]})]})]})})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("form",{onSubmit:k,children:e.jsxs(q,{children:[e.jsxs(F,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"female",name:"radio-buttons-group",row:!0,children:[e.jsx(f,{value:"all",control:e.jsx(g,{onChange:b}),checked:t.target==="all",label:"全員"}),e.jsx(f,{value:"no-answer",control:e.jsx(g,{onChange:b}),checked:t.target==="no-answer",label:"未回答"}),e.jsx(f,{value:"answer",control:e.jsx(g,{onChange:b}),checked:t.target==="answer",label:"回答済"})]}),e.jsx("div",{className:"text-center",children:e.jsx(x,{children:"抽出"})})]})})}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{style:{maxWidth:"650px"},className:"mx-auto",children:[e.jsx(ee,{component:G,children:e.jsxs(I,{"aria-label":"simple table",children:[e.jsx(J,{children:e.jsxs(y,{children:[e.jsx(i,{children:"NO."}),e.jsx(i,{children:"従業員ID"}),e.jsx(i,{children:"回答状況"})]})}),e.jsx(K,{children:s&&s.data.map((a,n)=>e.jsxs(y,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(i,{scope:"row",children:s.from+n}),e.jsx(i,{children:a.client_id}),e.jsx(i,{className:C.some(r=>r.id===a.id)?"":"bg-main text-main-cont",children:C.some(r=>r.id===a.id)?"回答済":"未回答"})]},a.id))})]})}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[(s==null?void 0:s.prev_page_url)&&e.jsx(x,{className:"mr-auto",children:e.jsx(N,{href:`/dashboard?target=${d}&page=${s.current_page-1}`,children:"前へ"})}),(s==null?void 0:s.next_page_url)&&e.jsx(x,{className:"ml-auto",children:e.jsx(N,{href:`/dashboard?target=${d}&page=${s.current_page+1}`,children:"次へ"})})]})]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(x,{onClick:A,children:"CSVダウンロード"})})]})})]})}export{Ce as default};
