import{r as u,W as y,j as t}from"./app-c92ce2d1.js";import{T as h}from"./Title-5c771be9.js";import{B as _}from"./Box-879b1cb9.js";import{C as T}from"./ClientAuthenticatedLayout-fed49ea7.js";import{A as w}from"./ApplicationLogo-7ba972c6.js";import{B as C}from"./Button-66d22b0c.js";import{S as A}from"./ScaleInputGroup-3ed4c19d.js";import{C as D}from"./Container-bbfe86f3.js";import{T as f,S as V}from"./TextField-d6d67c59.js";import{F as W}from"./FormControl-eebf705a.js";import{M as q}from"./MenuItem-f24dbe03.js";/* empty css            */import"./FormGroup-492150b4.js";import"./useFormControl-a9c41379.js";import"./TransitionGroupContext-9cacacb1.js";import"./ButtonBase-198d9617.js";import"./createSvgIcon-60ca7381.js";import"./Typography-1bfe8b9a.js";import"./extendSxProp-ddcd5154.js";import"./createChainedFunction-0bab83cf.js";import"./useId-6fe99ab6.js";import"./ResponsiveNavLink-1ea504f4.js";import"./transition-a4f3e77b.js";import"./Modal-e6edadb1.js";import"./debounce-517eeb3c.js";const v=(n,i)=>{let m={};return n?n.answers.map(s=>{m["q_"+s.question_id]=s.value}):i.forms.map(s=>{s.questions.map(p=>{m["q_"+p.id]=""})}),m},ne=({auth:n,survey:i,response:m,flash:s})=>{const[p,g]=u.useState([]);u.useState("");const{data:d,setData:j,post:b,put:N,processing:B,errors:E,reset:F}=y(v(m,i)),o=r=>{const a=r.target.name,e=r.target.value;let c={...d,[a]:e};j(c)};u.useEffect(()=>{j(v(m,i));const r=i.forms.reduce((a,e)=>{if(e.user_form_meta&&e.user_form_meta.value===0)return a;const c=e.questions.filter(l=>l.user_question_meta&&l.user_question_meta.value===0?!1:l.required).map(l=>`q_${l.id}`);return a.concat(c)},[]);g(r)},[i.id]);const S=r=>{r.preventDefault(),console.log(d),I()&&(m?N(route("client.survey.update",{survey_id:i.id})):b(route("client.survey.store",{survey_id:i.id})))},I=()=>{const r=p.filter(a=>!d[a]);return console.log(r),r.length?(alert("未入力の項目があります。"),!1):!0};return t.jsx(T,{user:n.user,children:t.jsx(D,{className:"py-12",children:t.jsxs("div",{children:[s&&t.jsx("div",{className:"bg-green-200 text-green-600 p-4 mb-4 rounded",children:s.message}),!s&&t.jsxs("form",{onSubmit:S,children:[t.jsxs("div",{children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx(w,{width:70,height:70,className:"mx-auto"}),t.jsx(h,{Tag:"h1",title:i.title})]}),i.forms.map(r=>{var a;return((a=r.user_form_meta)==null?void 0:a.value)!=0&&t.jsxs("div",{children:[t.jsx(h,{title:r.title,Tag:"h3",className:"p-4 mb-4 bg-main text-main-cont"}),t.jsx("div",{children:r.questions.map((e,c)=>{var l;return((l=e.user_question_meta)==null?void 0:l.value)!=0&&t.jsxs("div",{className:"mb-16",children:[t.jsx(h,{title:e.required?e.title+"*":e.title,Tag:"h4",className:"py-4 mb-4 border-b-2 border-main"}),e.type==="scale"&&e.scale&&t.jsx("div",{children:t.jsxs("div",{className:"mb-20",children:[t.jsxs("div",{className:"md:flex justify-between",children:[t.jsxs(_,{className:"mb-2 md:mb-0",children:["A: ",e.scale.min_text]}),t.jsxs(_,{children:["B: ",e.scale.max_text]})]}),t.jsx(A,{id:"q_"+e.id,name:"q_"+e.id,onChange:o,data:d["q_"+e.id]})]})}),e.type==="text"&&t.jsx("div",{children:t.jsx(f,{id:"q_"+e.id,type:"text",name:"q_"+e.id,defaultValue:d["q_"+e.id],variant:"outlined",onChange:o,fullWidth:!0,required:!!e.required})}),e.type==="textarea"&&t.jsxs("div",{children:[t.jsx(f,{id:"q_"+e.id,type:"text",name:"q_"+e.id,defaultValue:d["q_"+e.id],variant:"outlined",onChange:o,fullWidth:!0,multiline:!0,rows:4,required:!!e.required}),t.jsxs("div",{children:[d["q_"+e.id]?d["q_"+e.id].length:0,"文字"]})]}),e.type==="dropdown"&&e.choices&&t.jsx("div",{children:t.jsx(W,{fullWidth:!0,children:t.jsx(V,{labelId:"type",id:"q_"+e.id,name:"q_"+e.id,value:d["q_"+e.id],onChange:o,required:!!e.required,children:e.choices.map((x,L)=>t.jsx(q,{value:x.value,children:x.title},x.id))})})})]},e.id)})})]},r.id)})]}),t.jsx("div",{className:"text-center",children:t.jsxs(C,{className:"ml-4",disabled:B,children:[i.id===1&&"回答",i.id!==1&&"回答して次へ"]})})]})]})})})};export{ne as default};
