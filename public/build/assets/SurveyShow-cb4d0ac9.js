import{r as u,W as y,j as t}from"./app-d32edbdc.js";import{T as h}from"./Title-76a7b4c9.js";import{B as _}from"./Box-f1de9710.js";import{C as T}from"./ClientAuthenticatedLayout-1891e66c.js";import{A as w}from"./ApplicationLogo-48553c1b.js";import{B as C}from"./Button-9ea9dc2a.js";import{S as A}from"./ScaleInputGroup-70aadd25.js";import{C as D}from"./Container-4d29621e.js";import{T as f,S as V}from"./TextField-782215c9.js";import{F as W}from"./FormControl-5d3e1a59.js";import{M as q}from"./MenuItem-f1580150.js";/* empty css            */import"./FormGroup-b56a60c8.js";import"./useFormControl-71209524.js";import"./TransitionGroupContext-aa50d82c.js";import"./ButtonBase-ec7ce395.js";import"./createSvgIcon-b3555e53.js";import"./Typography-7784f584.js";import"./extendSxProp-0bb93aa5.js";import"./createChainedFunction-0bab83cf.js";import"./useId-b3d3b703.js";import"./ResponsiveNavLink-92a106bf.js";import"./transition-9075760d.js";import"./Modal-0fae64d2.js";import"./debounce-517eeb3c.js";const v=(n,i)=>{let m={};return n?n.answers.map(s=>{m["q_"+s.question_id]=s.value}):i.forms.map(s=>{s.questions.map(p=>{m["q_"+p.id]=""})}),m},ne=({auth:n,survey:i,response:m,flash:s})=>{const[p,g]=u.useState([]);u.useState("");const{data:d,setData:j,post:b,put:N,processing:B,errors:E,reset:F}=y(v(m,i)),o=r=>{const a=r.target.name,e=r.target.value;let c={...d,[a]:e};j(c)};u.useEffect(()=>{j(v(m,i));const r=i.forms.reduce((a,e)=>{if(e.user_form_meta&&e.user_form_meta.value===0)return a;const c=e.questions.filter(l=>l.user_question_meta&&l.user_question_meta.value===0?!1:l.required).map(l=>`q_${l.id}`);return a.concat(c)},[]);g(r)},[i.id]);const S=r=>{r.preventDefault(),console.log(d),I()&&(m?N(route("client.survey.update",{survey_id:i.id})):b(route("client.survey.store",{survey_id:i.id})))},I=()=>{const r=p.filter(a=>!d[a]);return console.log(r),r.length?(alert("未入力の項目があります。"),!1):!0};return t.jsx(T,{user:n.user,children:t.jsx(D,{className:"py-12",children:t.jsxs("div",{children:[s&&t.jsx("div",{className:"bg-green-200 text-green-600 p-4 mb-4 rounded",children:s.message}),!s&&t.jsxs("form",{onSubmit:S,children:[t.jsxs("div",{children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx(w,{width:70,height:70,className:"mx-auto"}),t.jsx(h,{Tag:"h1",title:i.title})]}),i.forms.map(r=>{var a;return((a=r.user_form_meta)==null?void 0:a.value)!=0&&t.jsxs("div",{children:[t.jsx(h,{title:r.title,Tag:"h3",className:"p-4 mb-4 bg-main text-main-cont"}),t.jsx("div",{children:r.questions.map((e,c)=>{var l;return((l=e.user_question_meta)==null?void 0:l.value)!=0&&t.jsxs("div",{className:"mb-16",children:[t.jsx(h,{title:e.required?e.title+"*":e.title,Tag:"h4",className:"py-4 mb-4 border-b-2 border-main"}),e.type==="scale"&&e.scale&&t.jsx("div",{children:t.jsxs("div",{className:"mb-20",children:[t.jsxs("div",{className:"md:flex justify-between",children:[t.jsxs(_,{className:"mb-2 md:mb-0",children:["A: ",e.scale.min_text]}),t.jsxs(_,{children:["B: ",e.scale.max_text]})]}),t.jsx(A,{id:"q_"+e.id,name:"q_"+e.id,onChange:o,data:d["q_"+e.id]})]})}),e.type==="text"&&t.jsx("div",{children:t.jsx(f,{id:"q_"+e.id,type:"text",name:"q_"+e.id,defaultValue:d["q_"+e.id],variant:"outlined",onChange:o,fullWidth:!0,required:!!e.required})}),e.type==="textarea"&&t.jsxs("div",{children:[t.jsx(f,{id:"q_"+e.id,type:"text",name:"q_"+e.id,defaultValue:d["q_"+e.id],variant:"outlined",onChange:o,fullWidth:!0,multiline:!0,rows:4,required:!!e.required}),t.jsxs("div",{children:[d["q_"+e.id]?d["q_"+e.id].length:0,"文字"]})]}),e.type==="dropdown"&&e.choices&&t.jsx("div",{children:t.jsx(W,{fullWidth:!0,children:t.jsx(V,{labelId:"type",id:"q_"+e.id,name:"q_"+e.id,value:d["q_"+e.id],onChange:o,required:!!e.required,children:e.choices.map((x,L)=>t.jsx(q,{value:x.value,children:x.title},x.id))})})})]},e.id)})})]},r.id)})]}),t.jsx("div",{className:"text-center",children:t.jsxs(C,{className:"ml-4",disabled:B,children:[i.id===1&&"回答",i.id!==1&&"回答して次へ"]})})]})]})})})};export{ne as default};
